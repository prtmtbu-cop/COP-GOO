<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>COP-GOO | Smart Data Viewer</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://unpkg.com/@phosphor-icons/web@2.0.3/src/regular/style.css" rel="stylesheet">

<style>
:root{
 --primary:#2563eb;
 --bg:#f4f7fb;
 --card:#ffffff;
 --muted:#6b7280;
}
*{box-sizing:border-box;font-family:Inter,sans-serif}
body{margin:0;background:var(--bg)}

header{
 background:linear-gradient(135deg,#2563eb,#1e40af);
 color:#fff;padding:22px;text-align:center
}
header h1{margin:0;font-size:22px}
header p{margin:6px 0 0;font-size:13px;opacity:.9}

.container{max-width:960px;margin:-28px auto 40px;padding:0 16px}

.search{
 background:#fff;padding:14px;border-radius:16px;
 display:flex;gap:10px;
 box-shadow:0 10px 25px rgba(0,0,0,.08)
}
.search input{
 flex:1;padding:14px;border-radius:12px;
 border:1px solid #e5e7eb;font-size:16px
}
.search button{
 background:var(--primary);color:#fff;border:none;
 padding:0 22px;border-radius:12px;font-weight:600
}

.status{text-align:center;margin:18px 0;color:var(--muted)}

.card{
 background:var(--card);border-radius:20px;
 padding:18px;margin-bottom:18px;
 box-shadow:0 8px 24px rgba(0,0,0,.06)
}

.card h2{margin:0 0 6px;font-size:18px}
.sub{font-size:13px;color:var(--muted)}

.badge{
 display:inline-block;padding:6px 14px;
 border-radius:999px;font-weight:700;font-size:12px
}
.green{background:#dcfce7;color:#16a34a}
.yellow{background:#fef3c7;color:#f59e0b}
.red{background:#fee2e2;color:#dc2626}

.grid{
 display:grid;gap:12px;margin-top:14px
}
.grid-2{grid-template-columns:repeat(2,1fr)}
.grid-3{grid-template-columns:repeat(3,1fr)}

.item{
 background:#f8fafc;border-radius:14px;
 padding:14px
}
.item i{font-size:18px;color:var(--primary)}
.item .label{font-size:12px;color:var(--muted)}
.item .value{font-weight:700;margin-top:2px}

.detail{
 margin-top:14px;border-top:1px dashed #e5e7eb;padding-top:12px
}
.detail-row{
 display:flex;justify-content:space-between;
 padding:6px 0;font-size:13px
}

footer{
 text-align:center;font-size:12px;
 color:var(--muted);padding:20px
}
</style>
</head>

<body>

<header>
<h1>COP-GOO</h1>
<p>Smart Warehouse Data · by @bunshin</p>
</header>

<div class="container">

<div class="search">
 <input id="key" placeholder="Masukkan RSV">
 <button onclick="search()">Cari</button>
</div>

<div id="status" class="status"></div>
<div id="result"></div>

</div>

<footer>© 2026 COP-GOO</footer>

<script>
const SID="1MylKkzqWHeZslTInhMk0ntPAQSczXmd2ZOYsSe1xDkI";
const SHEET="Sheet1";

function badge(s){
 if(!s) return "";
 s=s.toUpperCase();
 if(s.includes("FULL")) return `<span class="badge green">${s}</span>`;
 if(s.includes("KOSONG")) return `<span class="badge red">${s}</span>`;
 return `<span class="badge yellow">${s}</span>`;
}

function search(){
 const k=document.getElementById("key").value.trim();
 if(!k) return;

 document.getElementById("status").innerText="Mengambil data...";
 document.getElementById("result").innerHTML="";

 fetch(`https://docs.google.com/spreadsheets/d/${SID}/gviz/tq?sheet=${SHEET}&tq=`+
 encodeURIComponent(`select * where A='${k}'`))
 .then(r=>r.text()).then(t=>{
  const j=JSON.parse(t.substring(t.indexOf('{'),t.lastIndexOf('}')+1));
  const rows=j.table.rows;
  const cols=j.table.cols.map(c=>c.label);

  if(!rows.length){
   document.getElementById("status").innerText="❌ Data tidak ditemukan";
   return;
  }

  document.getElementById("status").innerText=`✅ ${rows.length} data ditemukan`;

  let html="";
  rows.forEach((r,idx)=>{
   const c=r.c;
   html+=`
   <div class="card">
    <h2>RSV ${c[0]?.v}</h2>
    ${badge(c[6]?.v)}
    <div class="sub">${c[1]?.f ?? ""} · ${c[2]?.v ?? ""}</div>

    <div class="grid grid-3">
     <div class="item"><i class="ph-user"></i><div class="label">COP</div><div class="value">${c[3]?.v||"-"}</div></div>
     <div class="item"><i class="ph-clock"></i><div class="label">Shift</div><div class="value">${c[4]?.v||"-"}</div></div>
     <div class="item"><i class="ph-truck"></i><div class="label">Request</div><div class="value">${c[7]?.v||"-"}</div></div>
    </div>

    <div class="detail">
   `;
   c.forEach((v,i)=>{
     html+=`
     <div class="detail-row">
      <span>${cols[i]}</span>
      <b>${v?.f ?? v?.v ?? "-"}</b>
     </div>`;
   });
   html+=`</div></div>`;
  });

  document.getElementById("result").innerHTML=html;
 });
}
</script>

</body>
</html>
