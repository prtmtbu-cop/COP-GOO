<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>COP-GOO Data Viewer</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:16px;
}
h1{
  text-align:center;
  margin-bottom:10px;
}
#result{
  overflow-x:auto;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
}
th,td{
  border:1px solid #ddd;
  padding:8px;
  font-size:14px;
}
th{
  background:#0b5ed7;
  color:#fff;
  position:sticky;
  top:0;
}
.loading{
  text-align:center;
  font-weight:bold;
  padding:20px;
}
.notfound{
  text-align:center;
  color:red;
  font-weight:bold;
}
footer{
  text-align:center;
  margin-top:16px;
  font-size:12px;
  color:#666;
}
</style>
</head>

<body>

<h1>COP-GOO Data</h1>
<div id="result" class="loading">Loading data...</div>

<footer>
  COP-GOO by @bunshin
</footer>

<script>
const SPREADSHEET_ID = "SPREADSHEET_ID_ANDA";
const SHEET_NAME = "Sheet1"; // sesuaikan

function loadData(){
  const query = "select *";
  const url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?sheet=${SHEET_NAME}&tq=` 
              + encodeURIComponent(query);

  fetch(url)
    .then(res => res.text())
    .then(text => {
      const json = JSON.parse(text.substring(47, text.length - 2));
      const table = json.table;

      if(!table || !table.rows || table.rows.length === 0){
        showNotFound();
        return;
      }

      renderTable(table);
    })
    .catch(err=>{
      console.error(err);
      showNotFound();
    });
}

function renderTable(table){
  let html = "<table><tr>";

  // HEADER
  table.cols.forEach(col=>{
    html += `<th>${col.label || "-"}</th>`;
  });
  html += "</tr>";

  // ROWS
  table.rows.forEach(r=>{
    html += "<tr>";
    r.c.forEach(c=>{
      html += `<td>${c?.f || c?.v || ""}</td>`;
    });
    html += "</tr>";
  });

  html += "</table>";
  document.getElementById("result").innerHTML = html;
}

function showNotFound(){
  document.getElementById("result").innerHTML =
    "<div class='notfound'>DATA TIDAK DITEMUKAN</div>";
}

window.onload = loadData;
</script>

</body>
</html>
