<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>COP-GOO | Visual Full Data</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://unpkg.com/@phosphor-icons/web@2.0.3/src/regular/style.css" rel="stylesheet">

<style>
:root{
 --blue:#2563eb;--green:#16a34a;--yellow:#f59e0b;--red:#dc2626;
 --bg:#f4f7fb;--card:#fff;--muted:#6b7280
}
*{box-sizing:border-box;font-family:Inter,sans-serif}
body{margin:0;background:var(--bg)}
header{
 background:linear-gradient(135deg,#2563eb,#1e40af);
 color:#fff;padding:22px;text-align:center
}
header h1{margin:0;font-size:22px}
header p{margin:6px 0 0;font-size:13px;opacity:.9}

.container{max-width:1000px;margin:-28px auto 40px;padding:0 16px}

.search{
 background:#fff;padding:14px;border-radius:16px;
 display:flex;gap:10px;box-shadow:0 10px 25px rgba(0,0,0,.08)
}
.search input{
 flex:1;padding:14px;border-radius:12px;
 border:1px solid #e5e7eb;font-size:16px
}
.search button{
 background:var(--blue);color:#fff;border:none;
 padding:0 22px;border-radius:12px;font-weight:600
}

.status{text-align:center;margin:18px 0;color:var(--muted)}

.card{
 background:var(--card);border-radius:18px;
 padding:18px;margin-bottom:16px;
 box-shadow:0 6px 20px rgba(0,0,0,.06)
}

.badge{
 display:inline-block;padding:6px 14px;
 border-radius:999px;font-weight:700;font-size:13px
}
.green{background:#dcfce7;color:var(--green)}
.yellow{background:#fef3c7;color:var(--yellow)}
.red{background:#fee2e2;color:var(--red)}

.section-title{
 font-size:14px;font-weight:700;
 color:var(--muted);margin-bottom:10px
}

.grid{
 display:grid;gap:14px
}
@media(min-width:768px){
 .grid-2{grid-template-columns:repeat(2,1fr)}
 .grid-3{grid-template-columns:repeat(3,1fr)}
}

.item{
 background:#f8fafc;border-radius:14px;
 padding:14px
}
.item i{color:var(--blue);font-size:18px}
.item .label{font-size:12px;color:var(--muted)}
.item .value{font-weight:700;font-size:15px}

.detail-row{
 display:flex;justify-content:space-between;
 padding:8px 0;border-bottom:1px dashed #e5e7eb;
 font-size:14px
}
.detail-row:last-child{border:none}

footer{text-align:center;font-size:12px;color:var(--muted);padding:20px}
</style>
</head>

<body>

<header>
 <h1>COP-GOO</h1>
 <p>Full Data Visual Viewer · by @bunshin</p>
</header>

<div class="container">

<div class="search">
 <input id="key" placeholder="Masukkan RSV">
 <button onclick="search()">Cari</button>
</div>

<div id="status" class="status"></div>
<div id="result"></div>

</div>

<footer>© 2026 COP-GOO</footer>

<script>
const SID="1MylKkzqWHeZslTInhMk0ntPAQSczXmd2ZOYsSe1xDkI";
const SNAME="Sheet1";

function badge(s){
 if(!s) return "";
 s=s.toUpperCase();
 if(s.includes("FULL")) return `<span class="badge green">${s}</span>`;
 if(s.includes("KOSONG")) return `<span class="badge red">${s}</span>`;
 return `<span class="badge yellow">${s}</span>`;
}

function search(){
 const k=document.getElementById("key").value.trim();
 if(!k) return;
 document.getElementById("status").innerText="Mengambil data...";
 document.getElementById("result").innerHTML="";

 fetch(`https://docs.google.com/spreadsheets/d/${SID}/gviz/tq?sheet=${SNAME}&tq=`+
 encodeURIComponent(`select * where A='${k}'`))
 .then(r=>r.text()).then(t=>{
  const j=JSON.parse(t.substring(47,t.length-2));
  if(!j.table.rows.length){
   document.getElementById("status").innerText="❌ Data tidak ditemukan";
   return;
  }

  const row=j.table.rows[0].c;
  const cols=j.table.cols.map(c=>c.label);
  document.getElementById("status").innerText="✅ Data ditemukan";

  let html=`
  <div class="card">
    <h2>RSV ${row[0].v}</h2>
    ${badge(row[6].v)}
    <div style="margin-top:8px;font-size:14px;color:#6b7280">
      ${row[1].f ?? row[1].v} · ${row[2].f ?? row[2].v}
    </div>
  </div>

  <div class="card">
   <div class="section-title">Informasi Utama</div>
   <div class="grid grid-3">
    <div class="item"><i class="ph-user"></i><div class="label">COP</div><div class="value">${row[3]?.v||"-"}</div></div>
    <div class="item"><i class="ph-clock"></i><div class="label">Shift</div><div class="value">${row[4]?.v||"-"}</div></div>
    <div class="item"><i class="ph-truck"></i><div class="label">Request</div><div class="value">${row[7]?.v||"-"}</div></div>
   </div>
  </div>

  <div class="card">
   <div class="section-title">Data Operasional</div>
   <div class="grid grid-2">
    <div class="item"><i class="ph-package"></i><div class="label">Total Item</div><div class="value">${row[8]?.v||0}</div></div>
    <div class="item"><i class="ph-stack"></i><div class="label">Total DO</div><div class="value">${row[9]?.v||0}</div></div>
   </div>
  </div>

  <div class="card">
   <div class="section-title">Data Lengkap</div>
  `;

  row.forEach((c,i)=>{
    html+=`
     <div class="detail-row">
       <div>${cols[i]}</div>
       <b>${c?.f ?? c?.v ?? "-"}</b>
     </div>`;
  });

  html+=`</div>`;
  document.getElementById("result").innerHTML=html;
 });
}
</script>

</body>
</html>
