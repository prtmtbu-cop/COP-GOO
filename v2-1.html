<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>COP-GOO | Completed Viewer</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://unpkg.com/@phosphor-icons/web@2.0.3/src/regular/style.css" rel="stylesheet">

<style>
:root{
 --blue:#2563eb;--green:#16a34a;--yellow:#f59e0b;--red:#dc2626;
 --bg:#f4f7fb;--card:#fff;--muted:#6b7280
}
*{box-sizing:border-box;font-family:Inter,sans-serif}
body{margin:0;background:var(--bg)}

header{
 background:linear-gradient(135deg,#2563eb,#1e40af);
 color:#fff;padding:24px;text-align:center
}
header h1{margin:0;font-size:22px}
header p{margin-top:6px;font-size:13px;opacity:.9}

.container{
 max-width:1100px;
 margin:-32px auto 40px;
 padding:0 16px
}

.search{
 background:#fff;padding:14px;border-radius:18px;
 display:flex;gap:10px;
 box-shadow:0 12px 28px rgba(0,0,0,.08)
}
.search input{
 flex:1;padding:14px;border-radius:14px;
 border:1px solid #e5e7eb;font-size:16px
}
.search button{
 background:var(--blue);color:#fff;
 border:none;padding:0 26px;
 border-radius:14px;font-weight:600
}

.status{
 text-align:center;margin:18px 0;
 color:var(--muted);font-size:14px
}

.card{
 background:var(--card);
 border-radius:20px;
 padding:18px;
 margin-bottom:18px;
 box-shadow:0 8px 24px rgba(0,0,0,.06)
}

.record-title{
 display:flex;justify-content:space-between;
 align-items:center;gap:10px
}
.record-title h2{
 margin:0;font-size:18px
}
.meta{
 font-size:13px;color:var(--muted)
}

.badge{
 padding:6px 14px;border-radius:999px;
 font-weight:700;font-size:12px
}
.green{background:#dcfce7;color:var(--green)}
.yellow{background:#fef3c7;color:var(--yellow)}
.red{background:#fee2e2;color:var(--red)}

.section-title{
 margin:6px 0 10px;
 font-size:13px;font-weight:700;
 color:var(--muted);text-transform:uppercase
}

.grid{display:grid;gap:14px}
@media(min-width:768px){
 .grid-3{grid-template-columns:repeat(3,1fr)}
 .grid-2{grid-template-columns:repeat(2,1fr)}
}

.item{
 background:#f8fafc;border-radius:16px;
 padding:14px
}
.item i{font-size:18px;color:var(--blue)}
.item .label{font-size:12px;color:var(--muted)}
.item .value{font-weight:700;font-size:15px}

.detail{
 display:flex;justify-content:space-between;
 gap:10px;padding:8px 0;
 border-bottom:1px dashed #e5e7eb;
 font-size:14px
}
.detail:last-child{border:none}

footer{
 text-align:center;font-size:12px;
 color:var(--muted);padding:22px
}
</style>
</head>

<body>

<header>
 <h1>COP-GOO</h1>
 <p>Completed Multi-Entry Data Viewer · by @bunshin</p>
</header>

<div class="container">

<div class="search">
 <input id="key" placeholder="Masukkan RSV (contoh: 718975)">
 <button onclick="search()">Cari</button>
</div>

<div id="status" class="status"></div>
<div id="result"></div>

</div>

<footer>© 2026 COP-GOO</footer>

<script>
const SID="1MylKkzqWHeZslTInhMk0ntPAQSczXmd2ZOYsSe1xDkI";
const SNAME="Sheet1";

function badge(val){
 if(!val) return "";
 val=val.toUpperCase();
 if(val.includes("FULL")) return `<span class="badge green">${val}</span>`;
 if(val.includes("KOSONG")) return `<span class="badge red">${val}</span>`;
 return `<span class="badge yellow">${val}</span>`;
}

function search(){
 const k=document.getElementById("key").value.trim();
 if(!k) return;

 document.getElementById("status").innerText="Mengambil data…";
 document.getElementById("result").innerHTML="";

 const query=`
 select *
 where A = ${Number(k)}
 order by B asc
 `;

 fetch(`https://docs.google.com/spreadsheets/d/${SID}/gviz/tq?sheet=${SNAME}&tq=`+
 encodeURIComponent(query))
 .then(r=>r.text())
 .then(t=>{
  const json=JSON.parse(t.substring(47,t.length-2));
  const rows=json.table.rows;
  const cols=json.table.cols.map(c=>c.label);

  if(!rows.length){
   document.getElementById("status").innerText="❌ Data tidak ditemukan";
   return;
  }

  document.getElementById("status").innerText=
   `✅ ${rows.length} data ditemukan`;

  let html="";

  rows.forEach((r,i)=>{
   const row=r.c;

   html+=`
   <div class="card">
    <div class="record-title">
     <h2>RSV ${row[0]?.v ?? "-"}</h2>
     ${badge(row[6]?.v)}
    </div>
    <div class="meta">
     Entry ke-${i+1} ·
     ${row[1]?.f ?? row[1]?.v ?? "-"} ·
     ${row[2]?.f ?? row[2]?.v ?? "-"}
    </div>
   </div>

   <div class="card">
    <div class="section-title">Informasi Utama</div>
    <div class="grid grid-3">
     <div class="item"><i class="ph-user"></i><div class="label">COP</div><div class="value">${row[3]?.v||"-"}</div></div>
     <div class="item"><i class="ph-clock"></i><div class="label">Shift</div><div class="value">${row[4]?.v||"-"}</div></div>
     <div class="item"><i class="ph-truck"></i><div class="label">Request</div><div class="value">${row[7]?.v||"-"}</div></div>
    </div>
   </div>

   <div class="card">
    <div class="section-title">Data Lengkap</div>
   `;

   row.forEach((c,idx)=>{
    html+=`
     <div class="detail">
      <div>${cols[idx]}</div>
      <b>${c?.f ?? c?.v ?? "-"}</b>
     </div>`;
   });

   html+=`</div>`;
  });

  document.getElementById("result").innerHTML=html;
 });
}
</script>

</body>
</html>
