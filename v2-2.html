<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>COP-GOO | Visual Data</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://unpkg.com/@phosphor-icons/web@2.0.3/src/regular/style.css" rel="stylesheet">

<style>
:root{
  --blue:#2563eb;
  --green:#16a34a;
  --yellow:#f59e0b;
  --red:#dc2626;
  --bg:#f4f7fb;
  --card:#fff;
  --muted:#6b7280;
}

*{box-sizing:border-box;font-family:Inter,sans-serif}

body{margin:0;background:var(--bg)}

header{
  background:linear-gradient(135deg,#2563eb,#1e40af);
  color:#fff;padding:22px;text-align:center
}

.container{max-width:900px;margin:-30px auto 40px;padding:0 16px}

.search{
  background:#fff;padding:14px;border-radius:16px;
  display:flex;gap:10px;box-shadow:0 10px 25px rgba(0,0,0,.08)
}

.search input{
  flex:1;padding:14px;border-radius:12px;
  border:1px solid #e5e7eb;font-size:16px
}
.search button{
  background:var(--blue);color:#fff;
  border:none;padding:0 22px;
  border-radius:12px;font-weight:600
}

.status{text-align:center;margin:18px 0;color:var(--muted)}

.card{
  background:var(--card);
  border-radius:18px;
  padding:18px;
  margin-bottom:16px;
  box-shadow:0 6px 20px rgba(0,0,0,.06)
}

.badge{
  display:inline-block;padding:6px 14px;
  border-radius:999px;font-weight:700;font-size:13px
}
.green{background:#dcfce7;color:var(--green)}
.yellow{background:#fef3c7;color:var(--yellow)}
.red{background:#fee2e2;color:var(--red)}

.summary{
  display:grid;gap:12px
}

.summary h2{margin:0;font-size:18px}

.grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:14px;margin-top:14px
}

.item{
  background:#f8fafc;
  border-radius:14px;
  padding:14px;
}

.item i{font-size:20px;color:var(--blue)}
.item .label{font-size:12px;color:var(--muted)}
.item .value{font-weight:700;font-size:16px}

.bar{
  height:8px;border-radius:999px;background:#e5e7eb;margin-top:6px;
  overflow:hidden
}
.bar span{
  display:block;height:100%;background:var(--blue)
}

footer{text-align:center;font-size:12px;color:var(--muted);padding:20px}
</style>
</head>

<body>

<header>
  <h1>COP-GOO</h1>
  <p>Visual Data Viewer · by @bunshin</p>
</header>

<div class="container">

<div class="search">
  <input id="key" placeholder="Masukkan RSV">
  <button onclick="load()">Cari</button>
</div>

<div id="status" class="status"></div>
<div id="result"></div>

</div>

<footer>© 2026 COP-GOO</footer>

<script>
const SID="1MylKkzqWHeZslTInhMk0ntPAQSczXmd2ZOYsSe1xDkI";
const SNAME="Sheet1";

function badge(s){
 if(!s) return "";
 s=s.toUpperCase();
 if(s.includes("FULL")) return `<span class="badge green">${s}</span>`;
 if(s.includes("KOSONG")) return `<span class="badge red">${s}</span>`;
 return `<span class="badge yellow">${s}</span>`;
}

function load(){
 const k=document.getElementById("key").value.trim();
 if(!k) return;
 document.getElementById("status").innerText="Mengambil data...";
 const q=`select * where A='${k}'`;
 const u=`https://docs.google.com/spreadsheets/d/${SID}/gviz/tq?sheet=${SNAME}&tq=${encodeURIComponent(q)}`;

 fetch(u).then(r=>r.text()).then(t=>{
  const j=JSON.parse(t.substring(47,t.length-2));
  const rws=j.table.rows;
  if(!rws.length){
    document.getElementById("status").innerText="Data tidak ditemukan";
    document.getElementById("result").innerHTML="";
    return;
  }
  const c=rws[0].c;
  document.getElementById("status").innerText="Data ditemukan";

  document.getElementById("result").innerHTML=`
  <div class="card summary">
    <h2>RSV ${c[0].v}</h2>
    ${badge(c[6].v)}
    <div class="grid">
      <div class="item"><i class="ph-calendar"></i><div class="label">Tanggal</div><div class="value">${c[1].f}</div></div>
      <div class="item"><i class="ph-user"></i><div class="label">COP</div><div class="value">${c[2].v}</div></div>
      <div class="item"><i class="ph-clock"></i><div class="label">Jam</div><div class="value">${c[5].f}</div></div>
      <div class="item"><i class="ph-truck"></i><div class="label">Request</div><div class="value">${c[7].v}</div></div>
      <div class="item"><i class="ph-package"></i><div class="label">Total Item</div><div class="value">${c[8].v}</div>
        <div class="bar"><span style="width:${c[8].v*10}%"></span></div>
      </div>
      <div class="item"><i class="ph-stack"></i><div class="label">Total DO</div><div class="value">${c[9].v}</div>
        <div class="bar"><span style="width:${c[9].v*20}%"></span></div>
      </div>
    </div>
  </div>`;
 });
}
</script>

</body>
</html>
