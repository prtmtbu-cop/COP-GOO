<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>COP-GOO | Operational Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://unpkg.com/@phosphor-icons/web@2.0.3/src/regular/style.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
 --blue:#2563eb;--green:#16a34a;--yellow:#f59e0b;--red:#dc2626;
 --bg:#f4f7fb;--card:#fff;--muted:#6b7280
}
*{box-sizing:border-box;font-family:Inter,sans-serif}
body{margin:0;background:var(--bg)}
header{
 background:linear-gradient(135deg,#2563eb,#1e40af);
 color:#fff;padding:22px
}
header h1{margin:0;font-size:22px}
header p{margin:4px 0 0;font-size:13px;opacity:.9}

.container{max-width:1100px;margin:-30px auto 40px;padding:0 16px}

.search{
 background:#fff;padding:14px;border-radius:16px;
 display:flex;gap:10px;box-shadow:0 10px 25px rgba(0,0,0,.08)
}
.search input{flex:1;padding:14px;border-radius:12px;border:1px solid #e5e7eb;font-size:16px}
.search button{background:var(--blue);color:#fff;border:none;padding:0 22px;border-radius:12px;font-weight:600}

.grid{
 display:grid;gap:16px;margin-top:18px
}
@media(min-width:768px){
 .grid{grid-template-columns:repeat(3,1fr)}
}

.card{
 background:var(--card);border-radius:18px;padding:18px;
 box-shadow:0 6px 20px rgba(0,0,0,.06)
}

.kpi{
 display:flex;align-items:center;gap:14px
}
.kpi i{font-size:26px;color:var(--blue)}
.kpi .value{font-size:22px;font-weight:700}
.kpi .label{font-size:13px;color:var(--muted)}

.status{text-align:center;margin:18px 0;color:var(--muted)}

footer{text-align:center;font-size:12px;color:var(--muted);padding:20px}
</style>
</head>

<body>

<header>
 <h1>COP-GOO</h1>
 <p>Operational Product Dashboard · by @bunshin</p>
</header>

<div class="container">

<div class="search">
 <input id="key" placeholder="Masukkan RSV">
 <button onclick="load()">Cari</button>
</div>

<div id="status" class="status"></div>

<div class="grid" id="kpi"></div>

<div class="grid">
 <div class="card"><canvas id="chartStatus"></canvas></div>
 <div class="card"><canvas id="chartItem"></canvas></div>
 <div class="card"><canvas id="chartDO"></canvas></div>
</div>

</div>

<footer>© 2026 COP-GOO</footer>

<script>
const SID="1MylKkzqWHeZslTInhMk0ntPAQSczXmd2ZOYsSe1xDkI";
const SNAME="Sheet1";
let cs,ci,cd;

function load(){
 const k=document.getElementById("key").value.trim();
 if(!k) return;
 document.getElementById("status").innerText="Mengambil data...";

 fetch(`https://docs.google.com/spreadsheets/d/${SID}/gviz/tq?sheet=${SNAME}&tq=`+
 encodeURIComponent(`select * where A='${k}'`))
 .then(r=>r.text()).then(t=>{
  const j=JSON.parse(t.substring(47,t.length-2));
  if(!j.table.rows.length){
   document.getElementById("status").innerText="Data tidak ditemukan";
   return;
  }
  const c=j.table.rows[0].c;
  document.getElementById("status").innerText="Data ditemukan";

  document.getElementById("kpi").innerHTML=`
  <div class="card kpi"><i class="ph-hash"></i><div><div class="value">${c[0].v}</div><div class="label">RSV</div></div></div>
  <div class="card kpi"><i class="ph-package"></i><div><div class="value">${c[8].v}</div><div class="label">Total Item</div></div></div>
  <div class="card kpi"><i class="ph-stack"></i><div><div class="value">${c[9].v}</div><div class="label">Total DO</div></div></div>
  `;

  drawCharts(c);
 });
}

function drawCharts(c){
 cs?.destroy();ci?.destroy();cd?.destroy();

 cs=new Chart(chartStatus,{
  type:"doughnut",
  data:{labels:["FULL","KOSONG"],
  datasets:[{data:[c[6].v.includes("FULL")?1:0,c[6].v.includes("KOSONG")?1:0],
  backgroundColor:["#16a34a","#dc2626"]}]},
  options:{plugins:{legend:{position:"bottom"}}}
 });

 ci=new Chart(chartItem,{
  type:"bar",
  data:{labels:["Item"],datasets:[{data:[c[8].v],backgroundColor:"#2563eb"}]},
  options:{plugins:{legend:{display:false}}}
 });

 cd=new Chart(chartDO,{
  type:"bar",
  data:{labels:["DO"],datasets:[{data:[c[9].v],backgroundColor:"#f59e0b"}]},
  options:{plugins:{legend:{display:false}}}
 });
}
</script>

</body>
</html>
